<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cyber Detective</title>
  <link rel="icon" type="image/png" href="assets/icon.png">
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #000C28;
      color: #e0e0e0;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 40px 20px;
    }

    h1, h2, h3, h4 {
      text-align: center;
      color: #00ffff;
    }

    p, li {
      line-height: 1.6;
      max-width: 800px;
      text-align: center;
      margin:auto;
    }

    .hidden {
      display: none;
    }

    button {
      padding: 12px 24px;
      background-color: #1f1f1f;
      border: 1px solid #00ffff;
      color: #00ffff;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      transition: background 0.2s;
      margin: 20px auto;
      display: block;
    }

    button:hover {
      background-color: #00ffff;
      color: #121212;
    }

    .clues-container {
      display: flex;
      gap: 16px;
      margin-top: 20px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .clue-box {
      background-color: #1e1e1e;
      border: 1px solid #00ffff;
      border-radius: 10px;
      padding: 20px;
      width: 180px;
      text-align: center;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .clue-box:hover {
      transform: scale(1.05);
      background-color: #00ffff;
      color: #121212;
    }

    #modal {
      position: fixed;
      top: 0;
      left: 0;
      height: 100vh;
      width: 100vw;
      background-color: rgba(0, 0, 0, 0.85);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    #modal-content {
      background-color: #1f1f1f;
      padding: 20px;
      border-radius: 8px;
      max-width: 600px;
      width: 100%;
      margin: 20px;
      border: 1px solid #00ffff;
    }

    #modal-content pre {
      white-space: pre-wrap;
      font-family: monospace;
    }

    #back-btn {
      margin-top: 40px;
    }

    .suspects {
      display: flex;
      flex-direction: column;
      gap: 20px;
      margin: 20px 0;
    }

    .suspect {
      background-color: #1f1f1f;
      border: 1px solid #00ffff;
      border-radius: 10px;
      padding: 20px;
      text-align: center;
    }

    .suspect img {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      object-fit: cover;
      margin-bottom: 10px;
      border: 2px solid #00ffff;
    }

    .suspect h4 {
      margin: 10px 0 5px;
      color: #00ffff;
    }

    @media (min-width: 768px) {
      .suspects {
        flex-direction: row;
        justify-content: center;
      }

      .suspect {
        width: 200px;
      }
    }
  </style>
</head>
<body>
  <img src="assets/logo.png" alt="Cyber Detective Logo" style="max-width:200px; margin-bottom:20px;">

  <!-- Intro Page -->
  <div id="intro">
    <h1>üïµÔ∏è‚Äç‚ôÇÔ∏è Cyber Detective</h1>
    <p>You are part of a special cyber investigation unit. A serious digital breach has occurred in a company. Your mission is to analyze the clues, discuss with your team, and build a solid case against one of the potential suspects. Be careful ‚Äî things are not always what they seem.</p>

    <h3>Suspects:</h3>
    <div class="suspects">
      <div class="suspect">
        <img src="assets/1.png" alt="Alex G.">
        <h4>Alex G.</h4>
        <p>A former IT technician recently let go after a heated argument with his manager.</p>
      </div>
      <div class="suspect">
        <img src="assets/2.png" alt="Jamie R.">
        <h4>Jamie R.</h4>
        <p>A young student known for bragging about hacking small websites just for fun.</p>
      </div>
      <div class="suspect">
        <img src="assets/3.png" alt="Sarah J.">
        <h4>Sarah J.</h4>
        <p>A respected marketing manager... but with unexplained meetings with a competitor.</p>
      </div>
      <div class="suspect">
        <img src="assets/hacker.png" alt="Unknown Hacker">
        <h4>Unknown (a.k.a. "The Shadow")</h4>
        <p>No records. No identity. Just traces left in the system...</p>
      </div>
    </div>

    <p>Each case contains 6 digital clues. You must read them carefully, take notes, and discuss with your group. Only one suspect is guilty in each case ‚Äî but all may have motives. Good luck, detectives!</p>
    <button id="startBtn">Start Investigation</button>
  </div>

  <!-- Case Display -->
  <div id="case" class="hidden">
    <!-- Title intentionally hidden to preserve suspense -->
    <div class="clues-container" id="clueButtons"></div>

    <button id="back-btn" onclick="goBack()">üîô End Investigation</button>

    <hr style="margin-top: 40px; width: 100%; border-color: #00ffff30" />
    <div style="display: flex; flex-direction: column; align-items: center; gap: 20px; margin-top: 20px;">
      <h3>üïµÔ∏è Select the Suspect:</h3>
      <div style="display: flex; flex-direction: row; flex-wrap: wrap; justify-content: center; gap: 40px;">
        <div id="accusedVisual" class="hidden" style="text-align: center;"></div>
        <div>
          <select id="suspectSelect" style="padding: 8px; border-radius: 6px;" onchange="previewSuspect()">
            <option disabled selected>Choose a suspect</option>
            <option value="alex">Alex G.</option>
            <option value="jamie">Jamie R.</option>
            <option value="sarah">Sarah J.</option>
            <option value="hacker">Unknown (The Shadow)</option>
          </select>
          <button onclick="accuseSuspect()" style="margin-top: 10px;">Accuse</button>
        </div> 
      </div>
    </div>

    <!-- Confirm Modal -->
    <div id="confirmModal" style="display:none; position:fixed; bottom:0; left:0; width:100%; background:#1e1e1e; border-top: 2px solid #00ffff;  z-index: 999;">
      <h3>Are you sure?</h3>
      <p>This action cannot be undone.</p>
      <button onclick="confirmAccusation()">‚úÖ Confirm</button>
      <button onclick="cancelAccusation()">‚ùå Cancel</button>
    </div>
  </div>

  <!-- Clue Modal -->
  <div id="modal" onclick="closeModal()">
    <div id="modal-content">
      <pre id="clueText">Clue content here...</pre>
    </div>
  </div>

  <script>
    // --- CASES: rewritten to be internal-only and cross-referenced with other suspects ---
    const cases = [
      {
        title: "Case 1: The Disgruntled Insider",
        clues: [
          // 1 Auth log (odd hour), service account used; cross-reference Jamie failed attempts
          "üîê Authentication Log (SIEM extract):\n02:43:12 ‚Äî Successful VPN auth via legacy service account 'svc-ops-archive'.\nNotes: Account owner not defined. 19 prior failed attempts from user 'jamie.r' observed earlier (02:31‚Äì02:42).",
          // 2 File access (HR), path hints insider knowledge
          "üìÅ File Access Audit:\n03:01:55 ‚Äî Accessed //corp-share/HR/Offboarding/Policies_Archive.pdf from host 'WS-IT-04'.\nUser Context: SID maps to decommissioned IT workstation profile.",
          // 3 Change ticket closed w/ initials
          "üßæ Change Management Record:\nTicket CHG-2287 auto-closed at 03:14 with note 'restore job ran'. Approver field empty. Comment initials: 'AG'.",
          // 4 USB mount on old IT machine
          "üíΩ Device Control Log:\nHost 'WS-IT-04' mounted removable media 'USB-PHOTO-01' (read-only). Same host flagged as 'pending deallocation' last month.",
          // 5 Email gateway autosave fragment (not explicit), cross-mention Sarah marketing
          "‚úâÔ∏è Mail Gateway (Draft Autosave):\n03:18 ‚Äî Temp message buffer updated from 'it-outbox@'. Content fragment: 'treated / not listened / finally done'. Routing to Marketing mailbox 'sarah.j' failed.",
          // 6 Badge vs login mismatch, Alex offsite; red herring to 'Unknown'
          "üö™ Badge vs VPN Correlation:\nNo physical entry recorded for 'Alex G.' past 24h, yet elevated access from IT subnet observed. TOR exit node sightings around the same window marked as 'UNKNOWN_ACTOR'."
        ]
      },
      {
        title: "Case 2: The Script Kiddie",
        clues: [
          // 1 Bruteforce pattern, generic UA; cross-mention Alex account lock
          "üõ°Ô∏è IDS/Firewall Summary:\n01:58‚Äì02:56 ‚Äî Credential stuffing on /auth with user rotation (guest, test, admin-old). User-Agent string 'Mozilla/5.0'. Account 'alex.g' temporarily locked at 02:12.",
          // 2 Admin panel weak endpoint found internally
          "üñ•Ô∏è Web App Log (Legacy Admin):\n02:56:03 ‚Äî HTTP 200 at /admin-old/?panel=site using cookie 'PHPSESSID=...' from external IP. Referrer: none.",
          // 3 VPN connection with student device fingerprint; cross-mention Sarah
          "üîó VPN Session Detail:\nNew device fingerprint 'LAPTOP-JR-02' connected via trial guest VPN at 02:58 for 4m12s. Internal wiki pages viewed: 'How_to_Reset_Admin_Theme'. Page 'BrandAssets' (owner: sarah.j) opened.",
          // 4 Proxy/DNS: tool lookups
          "üåê Proxy & DNS Resolver:\nRepeated lookups: 'brutetool-lite.zip', 'panel_exploits.txt'. Destination content categorized as 'Hacking Tools'.",
          // 5 Screenshot exfil via internal CDN (hint of Discord-like), internal-only log
          "üñºÔ∏è CDN Access Log:\n03:04 ‚Äî Upload to /cdn/user/temporary/ 'admin_dashboard.png' from guest VLAN. Retention: 24h.",
          // 6 Ransom-like note dropped via web content manager; cross-mention 'Unknown'
          "üß© CMS Change Trace:\n03:06 ‚Äî File '/public/notice.tmp' created by web-worker process.\nText: 'your layers are tissue' ‚Äî tag set 'lol'. Correlation engine links phrasing style to prior 'UNKNOWN_ACTOR' notes."
        ]
      },
      {
        title: "Case 3: The Competitor",
        clues: [
          // 1 Secure email gateway log‚Äîphish lookalike, internal view via proxy referrer
          "üì® Secure Mail Gateway:\n11:02 ‚Äî Message to 'sarah.j' from 'ceo-office@fincorp.co' passed SPF/DKIM checks (similar domain). Link redirected via tracking to '/download?file=q4_report.zip'.",
          // 2 Share storage download of blueprints
          "üì¶ Share Storage Audit:\n11:07 ‚Äî Download 'project_blueprints.zip' (842 MB) by user 'sarah.j' from '\\\\design-share\\R&D'. Preceded by permission grant to 'Marketing-Temp' group.",
          // 3 Print server job of confidential doc; cross-mention Alex request
          "üñ®Ô∏è Print Server Queue:\n11:12 ‚Äî Job 'Blueprints_A3_Color' sent from 'MARKETING-LAPTOP-07'. Ticket REQ-4419 (raised by 'alex.g') asked for temporary printer access previous day.",
          // 4 DNS/Proxy to competitor host
          "üåê DNS/Proxy Logs:\n11:20 ‚Äî Outbound to 'cdn.novatech-resources.com/assets/img/' from 'MARKETING-LAPTOP-07'. Category: Business.",
          // 5 MFA push approvals pattern (possible fatigue)
          "üîí MFA Event Timeline:\n11:03‚Äì11:06 ‚Äî 5 MFA push approvals for user 'sarah.j' from same device ID. Geo: typical. Timeframe atypically dense.",
          // 6 Calendar service audit; cross-mention Jamie
          "üìÖ Calendar Service Audit:\n'Lunch ‚Äî external' created by 'sarah.j' for Tue/Thu. Guest email masked (external). Prior event 'Website theme help ‚Äî Jamie R.' last week."
        ]
      },
      {
        title: "Case 4: The Shadow Hacker",
        clues: [
          // 1 TOR / new temp user
          "üï≥Ô∏è SIEM Correlation:\n02:03 ‚Äî Multiple auth attempts via TOR exit nodes. Transient account 'temp-sync' created and disabled within 6 minutes by 'system'.",
          // 2 EDR PowerShell encoded payload
          "üß™ EDR Telemetry (PowerShell):\n02:05 ‚Äî Encoded command executed (length 1,024 chars) on 'APP-SRV-02' spawning 'rundll32'. Parent process: 'w3wp.exe'.",
          // 3 DNS to fresh domain
          "üåê DNS Resolver:\n02:06 ‚Äî Queries 'unknown-realm.biz' (registered <24h). TTL unusually low (60s).",
          // 4 File integrity monitor‚Äîstaging archive created and removed
          "üóÇÔ∏è File Integrity Monitor:\n02:07 ‚Äî Created and deleted 'stage_tmp\\bundle.part03' under service account 'web-backup'. No user session mapped.",
          // 5 Legacy host resurfaced‚Äîcross-mention Alex device
          "üñ•Ô∏è Asset Inventory:\n02:08 ‚Äî Host 'WS-IT-04' (assigned to A. Gomez; status: decommission pending) beaconed for 11 seconds, then silent.",
          // 6 Proxy phrasing match‚Äîcross-mentions Sarah, Jamie indirectly
          "üó£Ô∏è Linguistic Fingerprint Engine:\nNote fragments seen in web-change temp files: 'doors / air / layers'. Prior similar phrasing tagged under unrelated incidents: marketing site edits (owner: sarah.j) and guest VLAN uploads (device: LAPTOP-JR-02)."
        ]
      }
    ];

    // --- App state & elements ---
    let currentCase = null;
    let selectedSuspect = null;

    const intro = document.getElementById("intro");
    const caseSection = document.getElementById("case");
    const modal = document.getElementById("modal");
    const clueText = document.getElementById("clueText");
    const clueButtons = document.getElementById("clueButtons");

    document.getElementById("startBtn").addEventListener("click", startGame);

    function startGame() {
      const randomIndex = Math.floor(Math.random() * cases.length);
      currentCase = cases[randomIndex];
      intro.classList.add("hidden");
      caseSection.classList.remove("hidden");

      clueButtons.innerHTML = "";
      document.getElementById("accusedVisual").classList.add("hidden");
      selectedSuspect = null;
      document.getElementById("suspectSelect").selectedIndex = 0;

      currentCase.clues.forEach((clue, index) => {
        const btn = document.createElement("div");
        btn.className = "clue-box";
        btn.textContent = `üîç Clue ${index + 1}`;
        btn.onclick = () => showClue(index);
        clueButtons.appendChild(btn);
      });
    }

    function showClue(index) {
      clueText.textContent = currentCase.clues[index];
      modal.style.display = "flex";
    }

    function closeModal() {
      modal.style.display = "none";
    }

    function goBack() {
      currentCase = null;
      caseSection.classList.add("hidden");
      intro.classList.remove("hidden");
    }

    // Ground truth mapping (unchanged)
    const correctSuspect = {
      "Case 1: The Disgruntled Insider": "alex",
      "Case 2: The Script Kiddie": "jamie",
      "Case 3: The Competitor": "sarah",
      "Case 4: The Shadow Hacker": "hacker"
    };

    function accuseSuspect() {
      const select = document.getElementById("suspectSelect");
      const value = select.value;
      if (!value) return;
      selectedSuspect = value;
      document.getElementById("confirmModal").style.display = "block";
    }

    function cancelAccusation() {
      selectedSuspect = null;
      document.getElementById("suspectSelect").selectedIndex = 0;
      document.getElementById("accusedVisual").classList.add("hidden");
      document.getElementById("confirmModal").style.display = "none";
    }

    function confirmAccusation() {
      document.getElementById("confirmModal").style.display = "none";
      const isCorrect = selectedSuspect === correctSuspect[currentCase.title];
      clueText.innerHTML = isCorrect
        ? `<img src='assets/case_solved.png' alt='Case Solved' style='max-width:120px; border: 1px solid #00ffff; display:block; margin:0 auto 16px; border-radius:50%;'/>‚úÖ Case closed. Well done, detective!`
        : `<img src='assets/suspect_escape.png' alt='Suspect Escapes' style='max-width:120px; border: 1px solid #ff0000; display:block; margin:0 auto 16px; border-radius:50%;'/>‚ùå The suspect escapes... The real intruder is still out there.`;
      modal.style.display = "flex";
      // (No re-render here; profile already shown by preview)
    }

    function renderAccusedCard(suspectKey) {
      const container = document.getElementById("accusedVisual");
      const suspectsData = {
        alex: { name: "Alex G.",   img: "1.png",      desc: "A former IT technician recently let go after a heated argument." },
        jamie:{ name: "Jamie R.",  img: "2.png",      desc: "A young student known for hacking small websites just for fun." },
        sarah:{ name: "Sarah J.",  img: "3.png",      desc: "A respected marketing manager... with unexplained meetings." },
        hacker:{name: "Unknown (The Shadow)", img: "hacker.png", desc: "No records. No identity. Just traces left in the system..." }
      };
      const s = suspectsData[suspectKey];
      if (!s) return;
      container.innerHTML = `
        <div class="suspect" style="margin: 0 auto;">
          <img src="assets/${s.img}" alt="${s.name}">
          <h4>${s.name}</h4>
          <p>${s.desc}</p>
        </div>
      `;
      container.classList.remove("hidden");
    }

    function previewSuspect() {
      const select = document.getElementById("suspectSelect");
      const value = select.value;
      if (!value) return;
      renderAccusedCard(value);
    }
  </script>
</body>
</html>
